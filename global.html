<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>spex API</title>
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="style.css">
</head>

<body>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-spex.html">spex</a></li></ul><h3>Externals</h3><ul><li><a href="external-Error.html">Error</a></li><li><a href="external-Promise.html">Promise</a></li><li><a href="external-TypeError.html">TypeError</a></li><li><a href="promise.external_all.html">all</a></li></ul><h3>Classes</h3><ul><li><a href="PromiseAdapter.html">PromiseAdapter</a></li></ul><h3>Namespaces</h3><ul><li><a href="errors.html">errors</a></li><li><a href="stream.html">stream</a></li></ul><h3>Interfaces</h3><ul><li><a href="errors.BatchError.html">BatchError</a></li><li><a href="errors.PageError.html">PageError</a></li><li><a href="errors.SequenceError.html">SequenceError</a></li></ul><h3>Global</h3><ul><li><a href="global.html#batch">batch</a></li><li><a href="global.html#page">page</a></li><li><a href="global.html#sequence">sequence</a></li></ul>
    <div class="home-link">
        <a href="https://github.com/vitaly-t/spex">&lt;&lt; GitHub</a>
    </div>
</nav>

<div id="main">
    




<section>

<header>
    
        <h2></h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

        


<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>


        
    
    </div>

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="batch"><span class="type-signature"></span>batch<span class="signature">(values, cb<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p><strong>Alternative Syntax:</strong>
<code>batch(values, {cb})</code> &#8658; <code>Promise</code></p>
<p>Settles (resolves or rejects) every <a href="https://github.com/vitaly-t/spex/wiki/Mixed-Values">mixed value</a> in the input array.</p>
<p>The method resolves with an array of results, the same as the standard <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all">promise.all</a>,
while providing comprehensive error details in case of a reject, in the form of
type <a href="errors.BatchError.html">BatchError</a>.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Array of <a href="https://github.com/vitaly-t/spex/wiki/Mixed-Values">mixed values</a> (it can be empty), to be resolved asynchronously, in no particular order.</p>
<p>Passing in anything other than an array will throw <a href="external-TypeError.html">TypeError</a> =
<code>Method 'batch' requires an array of values.</code></p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>
|

<span class="param-type">generator</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional callback (or generator) to receive the result for each settled value.</p>
<p>Callback Parameters:</p>
<ul>
<li><code>index</code> = index of the value in the source array</li>
<li><code>success</code> - indicates whether the value was resolved (<code>true</code>), or rejected (<code>false</code>)</li>
<li><code>result</code> = resolved data, if <code>success</code>=<code>true</code>, or else the rejection reason</li>
<li><code>delay</code> = number of milliseconds since the last call (<code>undefined</code> when <code>index=0</code>)</li>
</ul>
<p>The function inherits <code>this</code> context from the calling method.</p>
<p>It can optionally return a promise to indicate that notifications are handled asynchronously.
And if the returned promise resolves, it signals a successful handling, while any resolved
data is ignored.</p>
<p>If the function returns a rejected promise or throws an error, the entire method rejects
with <a href="errors.BatchError.html">BatchError</a> where the corresponding value in property <code>data</code>
is set to <code>{success, result, origin}</code>:</p>
<ul>
<li><code>success</code> = <code>false</code></li>
<li><code>result</code> = the rejection reason or the error thrown by the notification callback</li>
<li><code>origin</code> = the original data passed into the callback as object <code>{success, result}</code></li>
</ul></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="ext_batch.js.html">ext/batch.js</a>, <a href="ext_batch.js.html#line5">line 5</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The method resolves with an array of individual resolved results, the same as the standard <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all">promise.all</a>.
In addition, the array is extended with a hidden read-only property <code>duration</code> - number of milliseconds
spent resolving all the data.</p>
<p>The method rejects with <a href="errors.BatchError.html">BatchError</a> when any of the following occurs:</p>
<ul>
<li>one or more values rejected or threw an error while being resolved as a <a href="https://github.com/vitaly-t/spex/wiki/Mixed-Values">mixed value</a></li>
<li>notification callback <code>cb</code> returned a rejected promise or threw an error</li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="page"><span class="type-signature"></span>page<span class="signature">(source, dest<span class="signature-attributes">opt</span>, limit<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    



<div class="description">
    <p><strong>Alternative Syntax:</strong>
<code>page(source, {dest, limit})</code> &#8658; <code>Promise</code></p>
<p>Resolves a dynamic sequence of pages/arrays with <a href="https://github.com/vitaly-t/spex/wiki/Mixed-Values">mixed values</a>.</p>
<p>The method acquires pages (arrays of <a href="https://github.com/vitaly-t/spex/wiki/Mixed-Values">mixed values</a>) from the source function, one by one,
and resolves each page as a <a href="global.html#batch">batch</a>, till no more pages left or an error/reject occurs.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>source</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>
|

<span class="param-type">generator</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Expected to return a <a href="https://github.com/vitaly-t/spex/wiki/Mixed-Values">mixed value</a> that resolves with the next page of data (array of <a href="https://github.com/vitaly-t/spex/wiki/Mixed-Values">mixed values</a>).
Returning or resolving with <code>undefined</code> ends the sequence, and the method resolves.</p>
<p>The function is called with the same <code>this</code> context as the calling method.</p>
<p>Parameters:</p>
<ul>
<li><code>index</code> = index of the page being requested</li>
<li><code>data</code> = previously returned page, resolved as a <a href="global.html#batch">batch</a> (<code>undefined</code> when <code>index=0</code>)</li>
<li><code>delay</code> = number of milliseconds since the last call (<code>undefined</code> when <code>index=0</code>)</li>
</ul>
<p>If the function throws an error or returns a rejected promise, the method rejects with
object <code>{index, error, source}</code>:</p>
<ul>
<li><code>index</code> = index of the request that failed</li>
<li><code>error</code> = the error thrown or the rejection reason</li>
<li><code>source</code> = resolved <code>data</code> that was passed into the function</li>
</ul>
<p>And if the function returns or resolves with anything other than an array or <code>undefined</code>,
the method rejects with the same object, but with <code>error</code> set to <code>Unexpected data returned
from the source.</code></p>
<p>Passing in anything other than a function will throw <code>Invalid page source.</code></p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dest</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>
|

<span class="param-type">generator</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Optional destination function (or generator), to receive a resolved <a href="global.html#batch">batch</a> of data
for each page, process it and respond as required.</p>
<p>Parameters:</p>
<ul>
<li><code>index</code> = page index in the sequence</li>
<li><code>data</code> = page data resolved as a <a href="global.html#batch">batch</a></li>
<li><code>delay</code> = number of milliseconds since the last call (<code>undefined</code> when <code>index=0</code>)</li>
</ul>
<p>The function is called with the same <code>this</code> context as the calling method.</p>
<p>It can optionally return a promise object, if notifications are handled asynchronously.
And if a promise is returned, the method will not request another page from the <code>source</code>
function until the promise has been resolved.</p>
<p>If the function throws an error or returns a rejected promise, the sequence terminates,
and the method rejects with object <code>{index, error, dest}</code>:</p>
<ul>
<li><code>index</code> = index of the page passed into the function</li>
<li><code>error</code> = the error thrown or the rejection reason</li>
<li><code>dest</code> = resolved <a href="global.html#batch">batch</a> that was passed into the function</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>limit</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    0
                
                </td>
            

            <td class="description last"><p>Limits the maximum number of pages to be requested from the <code>source</code>. If the value is greater
than 0, the method will successfully resolve once the specified limit has been reached.</p>
<p>When <code>limit</code> isn't specified (default), the sequence is unlimited, and it will continue
till one of the following occurs:</p>
<ul>
<li><code>source</code> returns or resolves with <code>undefined</code> or an invalid value (non-array)</li>
<li>either <code>source</code> or <code>dest</code> functions throw an error or return a rejected promise</li>
</ul></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="ext_page.js.html">ext/page.js</a>, <a href="ext_page.js.html#line5">line 5</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>When successful, the method resolves with object <code>{pages, total, duration}</code>:</p>
<ul>
<li><code>pages</code> = number of pages resolved</li>
<li><code>total</code> = the sum of all page sizes (total number of values resolved)</li>
<li><code>duration</code> = number of milliseconds consumed by the method</li>
</ul>
<p>When the method fails, there are two types of rejects that may occur:</p>
<ul>
<li><em>Normal Reject</em>: when one of the pages failed to resolve as a <a href="global.html#batch">batch</a></li>
<li><em>Internal Reject</em>: caused by either the <code>source</code> or the <code>dest</code> functions</li>
</ul>
<p><em>Normal Rejects</em> are reported with object <code>{index, data}</code>:</p>
<ul>
<li><code>index</code> = index of the page rejected by method <a href="global.html#batch">batch</a></li>
<li><code>data</code> = the rejection data from method <a href="global.html#batch">batch</a></li>
</ul>
<p><em>Internal Rejects</em> are reported with object <code>{index, error, [source], [dest]}</code>:</p>
<ul>
<li><code>index</code> = index of the page for which the error/reject occurred</li>
<li><code>error</code> = the error thrown or the rejection reason</li>
<li><code>source</code> - set when caused by the <code>source</code> function (see <code>source</code> parameter)</li>
<li><code>dest</code> - set when caused by the <code>dest</code> function (see <code>dest</code> parameter)</li>
</ul>
<p>Object for both reject types has method <code>getError()</code> to simplify access to the error.
For <em>Normal Rejects</em> it will return <code>data.first</code> (see method <a href="global.html#batch">batch</a>),
and <code>error</code> value for the <em>Internal Rejects</em>.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="sequence"><span class="type-signature"></span>sequence<span class="signature">(source, dest<span class="signature-attributes">opt</span>, limit<span class="signature-attributes">opt</span>, track<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    



<div class="description">
    <p><strong>Alternative Syntax:</strong>
<code>sequence(source, {dest, limit, track})</code> &#8658; <code>Promise</code></p>
<p>Resolves a dynamic sequence of <a href="https://github.com/vitaly-t/spex/wiki/Mixed-Values">mixed values</a>.</p>
<p>The method acquires <a href="https://github.com/vitaly-t/spex/wiki/Mixed-Values">mixed values</a> from the source function, one at a time, and resolves them,
till either no more values left in the sequence or an error/reject occurs.</p>
<p>It supports both <a href="../concept/sequencing.md">linked and detached sequencing</a>.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>source</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>
|

<span class="param-type">generator</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Expected to return the next <a href="https://github.com/vitaly-t/spex/wiki/Mixed-Values">mixed value</a> to be resolved. Returning or resolving
with <code>undefined</code> ends the sequence, and the method resolves.</p>
<p>Parameters:</p>
<ul>
<li><code>index</code> = current request index in the sequence</li>
<li><code>data</code> = resolved data from the previous call (<code>undefined</code> when <code>index=0</code>)</li>
<li><code>delay</code> = number of milliseconds since the last call (<code>undefined</code> when <code>index=0</code>)</li>
</ul>
<p>The function is called with the same <code>this</code> context as the calling method.</p>
<p>If the function throws an error or returns a rejected promise, the sequence terminates,
and the method rejects with object <code>{index, error, source}</code>:</p>
<ul>
<li><code>index</code> = index of the request that failed</li>
<li><code>error</code> = the error thrown or the rejection reason</li>
<li><code>source</code> = resolved <code>data</code> that was passed into the function</li>
</ul>
<p>Passing in anything other than a function will throw <code>Invalid sequence source.</code></p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dest</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>
|

<span class="param-type">generator</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Optional destination function (or generator), to receive resolved data for each index,
process it and respond as required.</p>
<p>Parameters:</p>
<ul>
<li><code>index</code> = index of the resolved data in the sequence</li>
<li><code>data</code> = the data resolved</li>
<li><code>delay</code> = number of milliseconds since the last call (<code>undefined</code> when <code>index=0</code>)</li>
</ul>
<p>The function is called with the same <code>this</code> context as the calling method.</p>
<p>It can optionally return a promise object, if data processing is done asynchronously.
If a promise is returned, the method will not request another value from the <code>source</code> function,
until the promise has been resolved.</p>
<p>If the function throws an error or returns a rejected promise, the sequence terminates,
and the method rejects with object <code>{index, error, dest}</code>:</p>
<ul>
<li><code>index</code> = index of the data that was processed</li>
<li><code>error</code> = the error thrown or the rejection reason</li>
<li><code>dest</code> = resolved data that was passed into the function</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>limit</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    0
                
                </td>
            

            <td class="description last"><p>Limits the maximum size of the sequence. If the value is greater than 0, the method will
successfully resolve once the specified limit has been reached.</p>
<p>When <code>limit</code> isn't specified (default), the sequence is unlimited, and it will continue
till one of the following occurs:</p>
<ul>
<li><code>source</code> either returns or resolves with <code>undefined</code></li>
<li>either <code>source</code> or <code>dest</code> functions throw an error or return a rejected promise</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>track</code></td>
            

            <td class="type">
            
                
<span class="param-type">Boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    false
                
                </td>
            

            <td class="description last"><p>Changes the type of data to be resolved by this method. By default, it is <code>false</code>
(see the return result). When set to be <code>true</code>, the method tracks/collects all resolved data
into an array internally, and resolves with that array once the method has finished successfully.</p>
<p>It must be used with caution, as to the size of the sequence, because accumulating data for
a very large sequence can result in consuming too much memory.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="ext_sequence.js.html">ext/sequence.js</a>, <a href="ext_sequence.js.html#line5">line 5</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>When successful, the resolved data depends on parameter <code>track</code>. When <code>track</code> is <code>false</code>
(default), the method resolves with object <code>{total, duration}</code>:</p>
<ul>
<li><code>total</code> = number of values resolved by the sequence</li>
<li><code>duration</code> = number of milliseconds consumed by the method</li>
</ul>
<p>When <code>track</code> is <code>true</code>, the method resolves with an array of all the data that has been resolved,
the same way that the standard <code>promise.all</code> resolves. In addition, the array comes extended with
read-only property <code>duration</code> - number of milliseconds consumed by the method.</p>
<p>When the method fails, the reject result depends on which function caused the failure - <code>source</code>
or <code>dest</code>. See the two parameters for the rejection details.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    



        
    

    

    
</article>

</section>




</div>

<br class="clear">

<footer>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"></script>
</body>
</html>